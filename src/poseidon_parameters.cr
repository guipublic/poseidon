require "big"


class PoseidonParams
    @prime : BigInt         = BigInt.new(0)           # 
    @sbox : Int32           = 0             # alpha or inverse (-1) sbox, typically -1, 3 or 5
    @width : Int32          = 0             # width of the permutation function
    @partial_rounds : Int32 = 0             # Rp, number of partial rounds
    @full_rounds : Int32    = 0             # Rf, number of full rounds
    @bit_sequence = Array(Bool).new();      # for internal computation of round constants
    @round_constants = Array(BigInt).new();
    @mds_matrix = Hash(Tuple(Int32, Int32), Array(Array(BigInt))).new();        # maps field (size, width) to a mds_matrix

    def mds_matrix()
        n = Math.log(@prime, 2).ceil.to_i;
        return @mds_matrix[{n, @width}]
    end

    def set_round_constants(array)
        @round_constants = array.clone();
    end

    def set_mds_matrix(matrix)
        @mds_matrix[{Math.log(@prime, 2).ceil.to_i,@width}] = matrix
    end
    
    def round_constants()
        if (@round_constants.size() == 0)
            n = Math.log(@prime, 2).ceil.to_i;
            generate_constants(1, n, @width, @full_rounds, @partial_rounds, @prime)
        end
        return @round_constants;
    end

    def self.zero_pad(input : String, len : Int32)
        return "0"*Math.max(len - input.size, 0) + input
    end

    def init_generator
        @bit_sequence = Array(Bool).new();
        # Generate initial sequence based on parameters
        if @sbox < 0
            sbox = 1;
        else
            sbox = 0;
        end
        n = Math.log(@prime, 2).ceil.to_i;
        b1= PoseidonParams.zero_pad(sbox.to_s(2), 4);
        b2= PoseidonParams.zero_pad(n.to_s(2), 12);
        b3= PoseidonParams.zero_pad(@width.to_s(2), 12);
        b4= PoseidonParams.zero_pad(@full_rounds.to_s(2), 10) ;
        b5= PoseidonParams.zero_pad(@partial_rounds.to_s(2), 10) + "1"*30;

        bit_list = "01" + PoseidonParams.zero_pad(sbox.to_s(2), 4) + PoseidonParams.zero_pad(n.to_s(2), 12) + PoseidonParams.zero_pad(@width.to_s(2), 12) + PoseidonParams.zero_pad(@full_rounds.to_s(2), 10) + PoseidonParams.zero_pad(@partial_rounds.to_s(2), 10) + "1"*30;
        bit_list.each_char do |c|
            @bit_sequence.push(c=='1');
        end
        (0...160).each do |i|
            new_bit = @bit_sequence[62] ^ @bit_sequence[51] ^ @bit_sequence[38] ^ @bit_sequence[23] ^ @bit_sequence[13] ^ @bit_sequence[0];
            @bit_sequence.shift
            @bit_sequence.push(new_bit)
        end
        return ;
    end

    # Convert an array of 64 bits elements, represented as hexa string, into a big integer with LDS (first element of the array are the least significant bits)
    # Horizen big int representation
    def self.str16a_to_big_int(a : Array(String))
        str = "";
        a.reverse!
        a.each do |s|
            str += s
        end
        return BigInt.new(str,16);
    end

    # Convert an array of 64 bits elements, into a big integer with LDS (first element of the array are the least significant bits)
    # Horizen big int representation
    def self.u64a_to_big_int(a : Array(UInt64))
        a_str = Array(String).new
        a.each do |n|
            a_str.push(zero_pad(n.to_s(16), 16));
        end
        return str16a_to_big_int(a_str);
    end

    def initialize    
        @mds_matrix[{254,2}] = [[BigInt.new("0e5c5780437ce095bd4586680a11431deaebae1e4ffc6051957e5a3eaf73cb6e",16), BigInt.new("1d9240e3b852ebe3a4c32cb314a0f3d2ebebe1c8dd37594d343ba4fea9158aa8",16)],[BigInt.new("1bb74e5a86d0c998684133e67d35ca075b5a18779d70657e3227f60eb4e145a7",16), BigInt.new("05f516c75b51a01089087a79dfdce2738812405051f489bf9da8be5e275e4c40",16)]];
        @mds_matrix[{254,3}] = [[BigInt.new("109b7f411ba0e4c9b2b70caf5c36a7b194be7c11ad24378bfedb68592ba8118b",16), BigInt.new("16ed41e13bb9c0c66ae119424fddbcbc9314dc9fdbdeea55d6c64543dc4903e0",16), BigInt.new("2b90bba00fca0589f617e7dcbfe82e0df706ab640ceb247b791a93b74e36736d",16)],[BigInt.new("2969f27eed31a480b9c36c764379dbca2cc8fdd1415c3dded62940bcde0bd771",16), BigInt.new("2e2419f9ec02ec394c9871c832963dc1b89d743c8c7b964029b2311687b1fe23",16), BigInt.new("101071f0032379b697315876690f053d148d4e109f5fb065c8aacc55a0f89bfa",16)],[BigInt.new("143021ec686a3f330d5f9e654638065ce6cd79e28c5b3753326244ee65a1b1a7",16), BigInt.new("176cc029695ad02582a70eff08a6fd99d057e12e58e7d7b6b16cdfabc8ee2911",16), BigInt.new("19a3fc0a56702bf417ba7fee3802593fa644470307043f7773279cd71d25d5e0",16)]];   
        @mds_matrix[{254,4}] = [[BigInt.new("0417461eb0c9fea6fe77b2cef5a13bc19e7e4c5bd9ee0d0c7dfc4416f715feb6",16), BigInt.new("0e26b4e6326b8111cf231e1e742f70d9716605e2ec1922949853067a0c41058d",16), BigInt.new("2c6e2e54e59ea676c8f16d971f629f3d8e00b23f9e60a31e67c85dcfd3cb81b2",16), BigInt.new("03ac0cb9447a7b3e7631fe4de79609d408c69cf4c4cfebe60c79cdd1a85a3509",16)],[BigInt.new("0218b4ec3c0285952730e3258af6233962012cafa89aa51180fefae51e2896f6",16), BigInt.new("0a0f1bb3020280639955e159d58ead04063194a69ebeaee0099967d1878081e5",16), BigInt.new("0cc3e6a00ee0ba0f831f015f396faf3be6d63bc6ea51648d6dfcc671d6cc682e",16), BigInt.new("0134f3cc3c9dd5c2837558c1c288039e39228109b84d7990e146b68f73be1ffe",16)],[BigInt.new("085efd2ed3478dedf2ed45db26bf502029fd01e95302f93c31b6adb5d2162bea",16), BigInt.new("20a4a5a7dcd46124aa9d23886f8a6e06eba3ab71455e768f8ad1d0904a0bafba",16), BigInt.new("092a3d8716ed11b56310dffa78a9bb707e5edcf1988e2844740ca481e21c91ec",16), BigInt.new("2d726a5a02f45c3c5bc3059af1e36753d0b34432bb44b57279f64a264024b150",16)],[BigInt.new("138776f3ef9da21071ba79f3af585abb0ab062d4f1b9a93eaef3cf8e368da1a0",16), BigInt.new("1da42253018d4ce91a86168e671bb173e1f8d2e1bb7ce578cd719dea73e8dbb4",16), BigInt.new("0189f6acc85e2a8d4b0e8262e3144aea64860b21f06d4f1541ab6a91f874ad47",16), BigInt.new("2cf5117cd2fc4e2831e904e8ca1db110baef8374cdcb9af6536bd5c6415daba2",16)]];
        @mds_matrix[{254,5}] = [[BigInt.new("162d3b9977988f1ca31ec37ae852d63b2883d2923623284d1eba61e68b8e1707",16), BigInt.new("1c11d287432c100de043b1b75bdd1099e3ce6d551ef70081ebec32fb16a3faf8",16), BigInt.new("016bd12658170d26ed043055343bb15078d26da71510f3c524ff69910f605c78",16), BigInt.new("0823f57d1556aa89b62858464cf8c0e893aa90ff4a6e37fcdcd5b3e19d115d07",16), BigInt.new("08f085053ddb0a4f1c76b6fb82831d2b0a54321c3897f13e9aecbac825643403",16)],[BigInt.new("061181c5d0b6b2872eda6dfa80bc939e1f25357d24c3960f8b83270c4484e104",16), BigInt.new("05c1c09fd272e6c7edf22363501bdf8d299d4caac5b706e164e23963c93275fa",16), BigInt.new("0a6e9286a50b95f00e272c108cd5ddb9b71dce841ff0d54d266b706ea6464551",16), BigInt.new("0c600422409ac1b65643c91b5893cf666a2c5ba06cc43846c2809cd82638a496",16), BigInt.new("10362dfae69c8859980cfd81e9afe2aab32ed70e859340aaf456dd3a9b9e131b",16)],[BigInt.new("2908e3ad88d0fbf8258fbcab5e718ae0355bb51dbc9b2b3cf79e10e2b4520cdb",16), BigInt.new("119eb3df4fcf9bcd9130ef029284625a42df7cb0be6e98a29395ef8eb199f755",16), BigInt.new("27e8b1a15dce101c7340fda4fb6a0220d07eff2e482a1dcecda2acaf1cf89448",16), BigInt.new("2adecd6475b30bb05a5dd1717173c6b5391bfa5dabb104067e5e355f0396b3c9",16), BigInt.new("14c09fffd46c055e15ca7b3789a7d3c8071a241d93b6b7eb0aebf2b83ba9b287",16)],[BigInt.new("2241cf344652d29d4425d6d7ed7db01ee752982c639eddf2619743a319a205e3",16), BigInt.new("0d7e6f13bfa630853d411b94c6eff9ab7bbdf3aeddb054ba1cb1fe7829e1f619",16), BigInt.new("228617d86f72ee8aa14ca28d56af551f863c28551e8c19c099eb028f39d4a58f",16), BigInt.new("003bc2bcbfefc51d3df989d7b10ec60e0779f08c220e0a6b16d57de2e8f43d6d",16), BigInt.new("28c2fdf1805ac1bfc2566906c2b8fcc6d6b1d9b6489755cfd3662b20ec1ec74b",16)],[BigInt.new("1ed3fb9e451034f6125567327cec24e64efdff6c5a0a052aa2a55dfa4bb7ab06",16), BigInt.new("2586be358a55605baf2fcf3c0c30922923cefca0750543c13067c981218afa22",16), BigInt.new("0025d53a1e922e39b2bb37fc17498409b9a815cdf32669f23f59565becdb3fd9",16), BigInt.new("18d6c258cd1284c6b0f88ece26334332885bd33b23aaf706ecb235312ad6fdee",16), BigInt.new("097d4ebd06fa9b62c907fe4ffe446f6f0e7ae2b3520f6b5ddb2e41b95ac9a638",16)]];

        horizen_mtx_u64 = [
            [2645972488122500518_u64, 15174087784261972608_u64, 6012496592884668757_u64, 1688848912143501406_u64, 9408068342580935725_u64,11672250714878796655_u64, 4677362699477437319_u64, 5084801265611243754_u64, 1031670177470027200_u64, 6927805189305206633_u64, 15792063270661056320_u64, 339600880556469_u64],
            [16359646493365230172_u64, 7709485227181677178_u64, 2954552999531185332_u64, 10193364133313551196_u64, 11289063168883399699_u64, 667395769959704691_u64, 4301201812476630064_u64, 3869411317921241614_u64, 13655674401745581607_u64, 1241994357092252990_u64, 12323710157538861343_u64, 153099422782707_u64],
            [2068501425293330001_u64, 6330779978006357462_u64, 14413865757121026919_u64, 1367855504848125902_u64, 9948589321684976316_u64, 15014360609075146274_u64, 18418862617918910941_u64, 11316283769888288383_u64, 5992559557881408150_u64, 4889946892846205687_u64, 11691051292825635402_u64, 272733183405984_u64],
            [16359646493365230172_u64, 7709485227181677178_u64, 2954552999531185332_u64, 10193364133313551196_u64, 11289063168883399699_u64, 667395769959704691_u64, 4301201812476630064_u64, 3869411317921241614_u64, 13655674401745581607_u64, 1241994357092252990_u64, 12323710157538861343_u64, 153099422782707_u64],
            [2645972488122500518_u64, 15174087784261972608_u64, 6012496592884668757_u64, 16888489121435014067_u64, 9408068342580935725_u64, 11672250714878796655_u64, 4677362699477437319_u64, 5084801265611243754_u64, 1031670177470027200_u64, 6927805189305206633_u64, 15792063270661056320_u64, 339600880556469_u64],
            [12808334774796013055_u64, 6014810033042959692_u64, 18007003149979884301_u64, 9756749817021895528_u64, 12935258847809382779_u64, 2563582509321683994_u64, 10159093414348995465_u64, 7627091618146380391_u64, 13098543392133066749_u64, 9833810780432364434_u64, 3438108215511958627_u64, 156932927433464_u64],
            [2068501425293330001_u64, 6330779978006357462_u64, 14413865757121026919_u64, 1367855504848125902_u64, 9948589321684976316_u64, 15014360609075146274_u64, 18418862617918910941_u64, 11316283769888288383_u64, 5992559557881408150_u64, 4889946892846205687_u64, 11691051292825635402_u64, 272733183405984_u64],
            [12808334774796013055_u64, 6014810033042959692_u64, 18007003149979884301_u64, 9756749817021895528_u64, 12935258847809382779_u64, 2563582509321683994_u64, 10159093414348995465_u64, 7627091618146380391_u64, 13098543392133066749_u64, 9833810780432364434_u64, 3438108215511958627_u64, 156932927433464_u64],
            [2645972488122500518_u64, 15174087784261972608_u64, 6012496592884668757_u64, 16888489121435014067_u64, 9408068342580935725_u64, 11672250714878796655_u64, 4677362699477437319_u64, 5084801265611243754_u64, 1031670177470027200_u64, 6927805189305206633_u64, 15792063270661056320_u64, 339600880556469_u64]
        ]
        horizen_mtx = Array(Array(BigInt)).new();
        
        (0...9).each do |i|
            if i % 3 == 0
                horizen_mtx.push(Array(BigInt).new());
            end
            horizen_mtx[i//3].push(PoseidonParams.u64a_to_big_int(horizen_mtx_u64[i])); 
        end
        @mds_matrix[{753,3}] = horizen_mtx;

        horizen_cst = [[7915174607273826982_u64, 16079326147582823613_u64, 9355658796035144992_u64, 8510081566408291108_u64, 3376666811880675611_u64, 12465481858448862741_u64, 16757727699625303609_u64, 1360281042866297348_u64, 3235275994684364202_u64, 2493522768116896899_u64, 13832550841775647162_u64, 320729468055567_u64],
        [10140345286399379338_u64, 7170990822955787519_u64, 16709096773545678217_u64, 11012077889687991061_u64, 15003362665544646695_u64, 7185406982957425389_u64, 15985965997138387760_u64, 16070072767008919814_u64, 951616737537661688_u64, 9982011654689747015_u64, 11049913383537753030_u64, 187034104926785_u64],
        [7562571679821236800_u64, 15460058153391563764_u64, 94617581249909890_u64, 15684158351571526208_u64, 1989616031468145412_u64, 10847911418215377018_u64, 12128423221754563084_u64, 1120519188194687702_u64, 13814379307197026635_u64, 14924824919589768296_u64, 6576056369320084789_u64, 30129334743492_u64],
        [10017707992975984886_u64, 7011148189595000587_u64, 4783068612290201490_u64, 10169413495156331523_u64, 8908422473752400279_u64, 6026715536024106036_u64, 17072988775061534095_u64, 5145809356800764214_u64, 8330176920644016201_u64, 15226253448324157410_u64, 1470336061131503412_u64, 83191354212984_u64],
        [4445297899491466687_u64, 18426996889875207112_u64, 13768096997319648921_u64, 17248084601142930531_u64, 2751909767235176012_u64, 10370819052865993582_u64, 12454340460893976220_u64, 8286780260417324514_u64, 3206580160312587767_u64, 15641828457638938171_u64, 10663698674669352706_u64, 186467836506429_u64],
        [14023642213516493239_u64, 207862540864208576_u64, 10739577504848593866_u64, 4264160966910379090_u64, 16375787994098365415_u64, 14675532026238794278_u64, 4795219376610389706_u64, 12934494567920988670_u64, 11486170931078313821_u64, 143470069726445500_u64, 11073592080569781586_u64, 317273646459099_u64],
        [1647859353855831333_u64, 1743821316569467423_u64, 13944338330951126182_u64, 12386372655395459410_u64, 6992976787920371021_u64, 4651004787150378335_u64, 157539064372582638_u64, 1142960513731437354_u64, 15725188179825547934_u64, 9262164455992094405_u64, 12000119935642671163_u64, 69402947900494_u64],
        [13326196805571322861_u64, 1289771917722970652_u64, 1141414754811010790_u64, 67212098468571522_u64, 5287567464512287004_u64, 6419357807280170137_u64, 11714859941533126915_u64, 1795484318204035509_u64, 8196202857741266726_u64, 17181061945296122710_u64, 6948510404527790326_u64, 147830175817419_u64],
        [8322930691125989298_u64, 10113755414324261927_u64, 3077068274792307338_u64, 13557340477137017789_u64, 1570945485734335644_u64, 1838289431602384631_u64, 13728173138317188140_u64, 11209679679765190826_u64, 6319601055957783731_u64, 2476671274670486945_u64, 16601265175216281022_u64, 170665883518781_u64],
        [7752290016051376636_u64, 11066864732213279809_u64, 6826433507756271776_u64, 12332873683221421342_u64, 1635266454656010123_u64, 4866199616962365270_u64, 4924563070614224955_u64, 2978138248117704868_u64, 10524486390670877149_u64, 369729731912056561_u64, 18428234831242207009_u64, 49598061981592_u64],
        [18300008216685266054_u64, 10785742651009589563_u64, 2500704111191637928_u64, 509604079664929493_u64, 7393761125222037741_u64, 5206923684036074255_u64, 14082257241313537325_u64, 2289404692836733280_u64, 7972511551425399111_u64, 816296841675819604_u64, 3178350769986059065_u64, 212104272171675_u64],
        [2768920614579497848_u64, 10932364827284621333_u64, 11624036988969201407_u64, 13597001858818568106_u64, 2020563866478154437_u64, 3559820768092458887_u64, 14358310924370886113_u64, 10763939263189401766_u64, 1839553156008352007_u64, 14798537912932667715_u64, 15856725785990154116_u64, 367897105986407_u64],
        [17298840027459184075_u64, 367797220950601651_u64, 1957275020946214645_u64, 7376354925749892557_u64, 11130790339340255340_u64, 10996402836345072349_u64, 4930793029454104978_u64, 14084689739061972842_u64, 12159710934725369471_u64, 7778969270315934083_u64, 14936067063463940597_u64, 470029375665570_u64],
        [10718766816722469750_u64, 10691913068211019644_u64, 4739313461435797100_u64, 8983631314891787747_u64, 8629305853200179976_u64, 12661883601727657381_u64, 7585415268275284628_u64, 16817361963210579066_u64, 8529631937362220802_u64, 16717878535615943772_u64, 2707965903381190661_u64, 199494078846009_u64],
        [5112065739459012302_u64, 12258651051189114127_u64, 9714038764675815493_u64, 9912106720910013030_u64, 9806088776504253911_u64, 3072593527938775435_u64, 13220539787789575111_u64, 5144330201149996_u64, 16918629411847939447_u64, 331337333753110389_u64, 14476961675271625227_u64, 267982950446522_u64],
        [6675731964634328441_u64, 3999608073669491924_u64, 3316152090475513355_u64, 2740913464927750668_u64, 8700863141089766808_u64, 5547497883050302169_u64, 4475466001827147716_u64, 17050051067233797285_u64, 6011575779763057465_u64, 6994687242732089534_u64, 121082736073120681_u64, 340999808938843_u64],
        [14898595543018179927_u64, 14417814015011266018_u64, 5478120673621741070_u64, 10145309291870233183_u64, 4080478348535024301_u64, 7620264654288318995_u64, 11417267359608425013_u64, 13966334026049012501_u64, 15415302797121969149_u64, 13918010297798119803_u64, 14575330603125581796_u64, 13228552156698_u64],
        [11717647745023130587_u64, 13423753570328161677_u64, 9715025389745704002_u64, 5274447851302517398_u64, 6926737806914936643_u64, 8614498343822224821_u64, 11741204340928699771_u64, 819757187906382800_u64, 168563636948737465_u64, 3427673720666879726_u64, 5516592865951577094_u64, 230895174814489_u64],
        [7594512300220257291_u64, 71329023482349082_u64, 1625124930019537311_u64, 8387148993153778136_u64, 2134475600790181503_u64, 6645707671618478610_u64, 7875464797448317908_u64, 17447279679554492634_u64, 14167477531426180821_u64, 10411591325646674270_u64, 12798670807604441460_u64, 266215181472469_u64],
        [10689614217917085377_u64, 450744517465915792_u64, 5764636581623260295_u64, 14108720262089210717_u64, 13795329300802778996_u64, 17142023064205538277_u64, 18363948642297469026_u64, 447969932468935954_u64, 2188557796584179807_u64, 14838872230993415364_u64, 8347550289243369421_u64, 25965455547832_u64],
        [16379137163311198719_u64, 6170018176064701171_u64, 17070148339728464943_u64, 13767353236178828750_u64, 9128767103377460130_u64, 12595667036051875459_u64, 582758880234811328_u64, 4640520062201675001_u64, 7334017538297644279_u64, 7454753121022545379_u64, 14028026357866293444_u64, 195737598118487_u64],
        [6694326665044441424_u64, 16389559732826897696_u64, 7229625977094205052_u64, 14739233880001544524_u64, 10888681517408994729_u64, 5943815606240218127_u64, 17414699483604300501_u64, 5099274823097908057_u64, 8157813657783276788_u64, 16740609182186452835_u64, 5529114939239262890_u64, 484054561543626_u64],
        [13703640923483880620_u64, 17933248881330304294_u64, 7648412740597399717_u64, 246661536845127907_u64, 41906663533543217_u64, 6697777840196165352_u64, 16192130968424657201_u64, 1666058462780282343_u64, 12546362028556709400_u64, 2283674427087038568_u64, 9409624248586983042_u64, 108061346504389_u64],
        [15185056613469961449_u64, 3680691523692330082_u64, 7734734319835596101_u64, 11937994938666577950_u64, 15270106660670040554_u64, 17672968739650547386_u64, 8350880316953128183_u64, 7247578112014205884_u64, 7596814750891728637_u64, 865269033744878345_u64, 7357196926950045548_u64, 427584219504978_u64],
        [12957455081090504657_u64, 5054433087285068604_u64, 3257480934272896668_u64, 9065271594952619443_u64, 3018752311733772416_u64, 6424489081017176403_u64, 10809210759139345150_u64, 17375373403052028320_u64, 4687543832868052908_u64, 14140673666709015601_u64, 1185683829334027065_u64, 148952131190429_u64],
        [7421162661581096080_u64, 3093412802818134809_u64, 2485167161783115032_u64, 7715913067746208737_u64, 4202155686614666783_u64, 6287407648504024417_u64, 8618762995172330791_u64, 13987817527627111090_u64, 6929993425344923963_u64, 1961343601799765124_u64, 15454640624291816356_u64, 324825465684750_u64],
        [9619130117144719110_u64, 6844769447059088344_u64, 10807374491914645741_u64, 5312885905522040978_u64, 10276358194681749536_u64, 5303215030297357587_u64, 4173387669034554645_u64, 14984433513811878832_u64, 13707085133024193766_u64, 7532459168675606720_u64, 13247001148510513726_u64, 163361634149188_u64],
        [15646686868863068489_u64, 15990053112431303532_u64, 9826358666185515847_u64, 13807291299330902813_u64, 17704148142823455181_u64, 12793782990237516008_u64, 14029439774680539583_u64, 2411300890681656444_u64, 12085675214577679306_u64, 15644852151121345366_u64, 7940012247213839434_u64, 133539871562054_u64],
        [7768837586080942893_u64, 16309670541160383156_u64, 12678066495267518900_u64, 10623739978645647355_u64, 3276405168630448189_u64, 3869110447606884161_u64, 7288909732455813836_u64, 7771819949372476883_u64, 17382367259252946898_u64, 12699624752871152239_u64, 9280128915527900368_u64, 59428928323988_u64],
        [13756004824372787842_u64, 4324955724576441076_u64, 716519030867572681_u64, 17294651506971768678_u64, 1708310310625189618_u64, 11058005395959409981_u64, 12938978797066750205_u64, 11731850999060577066_u64, 9491290964496813088_u64, 17650242766275413504_u64, 12223113919554542953_u64, 166942343400190_u64],
        [10527993188218645617_u64, 11836033812916199937_u64, 18185549091886904195_u64, 4555141371007256829_u64, 4785838079621021081_u64, 2247375599025542495_u64, 6143016155512367734_u64, 4428290322639970376_u64, 7893524446933816693_u64, 16027439212478767620_u64, 1590814313932821745_u64, 307769846167244_u64],
        [10332740361496400710_u64, 3262042935551763360_u64, 3462574856610573136_u64, 875318131587796211_u64, 7178585433808442663_u64, 5529412911172956565_u64, 13559278670063008411_u64, 2089979037480107982_u64, 9964844668981479689_u64, 3665699211702154199_u64, 13118899480406330279_u64, 343233938910116_u64],
        [2886928697991584772_u64, 6734524536973760019_u64, 81682375715259702_u64, 17586359546569946501_u64, 3269092440118830368_u64, 5707847554501570910_u64, 13457208725914988191_u64, 10593558028552956757_u64, 5364794163106323024_u64, 7548750126346685473_u64, 1680714725466888644_u64, 40418121888671_u64],
        [11046164340891821720_u64, 15902496426732192340_u64, 12415185079814057951_u64, 11540177786569552113_u64, 13992647956743047059_u64, 5488396714351606942_u64, 17784289267105780613_u64, 18172630437647253607_u64, 15088364264027123859_u64, 4745839939546445856_u64, 7078016635514787795_u64, 274384910127823_u64],
        [707030485142193360_u64, 13766968526142454873_u64, 16147420897128459216_u64, 12853592796666817355_u64, 9727459018404196119_u64, 13291526153280498563_u64, 17317719490497072085_u64, 1441976510689808079_u64, 5520630453916316542_u64, 14533386321618221081_u64, 5317855174651918151_u64, 166073015330890_u64],
        [12146819979524160453_u64, 571349478859812224_u64, 15067610214073261400_u64, 17029204315349092928_u64, 2196491931851891857_u64, 4933502109764219645_u64, 2193554654010978196_u64, 6586673499036876456_u64, 11573926401220548175_u64, 15891213754949074372_u64, 1096617844168312936_u64, 127135182952522_u64],
        [12386352435615268006_u64, 5611922985006753631_u64, 11145107904365672456_u64, 9515452878549810727_u64, 13490776302912849713_u64, 1466602332730372938_u64, 14442557979175789669_u64, 12736716954662585716_u64, 3116227819613120275_u64, 5229842626128614798_u64, 13536879302575662132_u64, 497785699886612_u64],
        [10420907769350977003_u64, 14124965926280386488_u64, 11624420366752671344_u64, 14275725469214081149_u64, 10376138629729613529_u64, 9101056661057313115_u64, 15696556053542717507_u64, 8385693768698475919_u64, 4185047460687103253_u64, 13297638216910291797_u64, 15495841907735048638_u64, 194797355277842_u64],
        [2799626506634526210_u64, 16562815984659650957_u64, 11791519379792043918_u64, 16800198403580373352_u64, 12283440122559828161_u64, 9618294265108560174_u64, 18228604979218267967_u64, 8817049879448473473_u64, 9489404409722191726_u64, 8566037664432522891_u64, 2255281851703326742_u64, 480206737153445_u64],
        [3669341368717952651_u64, 3592855231744268634_u64, 2766326960461885652_u64, 4726619319529614893_u64, 14084537441224141107_u64, 7478572075223602446_u64, 16871889012697162255_u64, 10067520093253220193_u64, 3500707636559770202_u64, 16841596043471695442_u64, 3985578344186420826_u64, 175015110244594_u64],
        [6772665123772338401_u64, 11565641515202527988_u64, 15991680797016202344_u64, 5404396380793898693_u64, 17627228860851607298_u64, 2061313415212463385_u64, 11151658148936182098_u64, 11571779643730905084_u64, 1163462530475372606_u64, 10066949402630665227_u64, 8163011582573433442_u64, 355130200708764_u64],
        [6890582499398601697_u64, 1080208878302748192_u64, 13074053098027970011_u64, 6427389838648520138_u64, 15385520230272492307_u64, 11347748691531244627_u64, 4457844083705029365_u64, 9847422313152443922_u64, 10571073811113741087_u64, 6794129256402674777_u64, 8575859450738309246_u64, 405740406550428_u64],
        [8771931804893813039_u64, 8965149616788627505_u64, 5127114382805031127_u64, 9542963315509695577_u64, 16047822566015613007_u64, 5548855879916243046_u64, 13357912239098670131_u64, 14041579145893166673_u64, 2004502849839997794_u64, 7233763449730219223_u64, 16170590912115240476_u64, 289075124951805_u64],
        [3318422954161752741_u64, 4048415822773526087_u64, 13815128516860105069_u64, 656578897024895291_u64, 13989640062300391935_u64, 712777253923264235_u64, 11102866971608420262_u64, 895424575448488825_u64, 6499150371114232363_u64, 9908393042692284108_u64, 1382172722543984283_u64, 152310275423992_u64],
        [12397669351633376058_u64, 10283251726495373288_u64, 266160095726989971_u64, 7259910069151586493_u64, 18094593052071034967_u64, 3873934062680649189_u64, 63017025384695230_u64, 10756189317721915837_u64, 6014360076404062088_u64, 2117358763266925409_u64, 9807026591740685768_u64, 443622709155059_u64],
        [10091120548115265686_u64, 11912590146272114452_u64, 2285511435323061559_u64, 3089847403457027557_u64, 7566147735315042103_u64, 4845801874466737232_u64, 13891330093718622278_u64, 2496087197041372866_u64, 16691664810074677950_u64, 5376404110704971632_u64, 15474125076266883044_u64, 79444069915394_u64],
        [2965342400943796446_u64, 15568274698133699900_u64, 3518020889883106168_u64, 5270477028378887915_u64, 76799241544023571_u64, 12364832673602329948_u64, 10838613048114973283_u64, 1467379454796838382_u64, 16257833021729463251_u64, 4513612521782823177_u64, 11945143533021143001_u64, 206231031407084_u64],
        [7506972016436481155_u64, 3838970963385970399_u64, 17204003851490288392_u64, 17691019667483111140_u64, 4593017934140139378_u64, 1001255864194049110_u64, 10708010672736218055_u64, 3317763456644171844_u64, 5038700260802425772_u64, 18332246172092575815_u64, 2462673802782631611_u64, 171123527857382_u64],
        [10901193702598068422_u64, 7811469421903586457_u64, 4817792176642870031_u64, 15129784967157869226_u64, 5378622502955370826_u64, 13871394443200627655_u64, 11570204771157421285_u64, 4595464966248948381_u64, 3384937958804004138_u64, 1132752620404829058_u64, 10044091291632211957_u64, 380436794713297_u64],
        [10124352221200819871_u64, 14786852239323655678_u64, 929270767526145537_u64, 15939503144518858067_u64, 7152518680289272207_u64, 6667136572763467872_u64, 14830599519059472469_u64, 572834655931838113_u64, 16060526660195862468_u64, 6995791234165654787_u64, 14647802420346299575_u64, 193164545074151_u64],
        [1965605368327961765_u64, 8469161271579952104_u64, 1769441042411027276_u64, 10300412983947637962_u64, 5244545923370433366_u64, 17069099239981760418_u64, 1112390411726687307_u64, 9775929803400421366_u64, 6256756942778668109_u64, 9336156787090080789_u64, 2453941735687494489_u64, 280459518832005_u64],
        [863087639766519402_u64, 16896289154457279376_u64, 15042818548048455297_u64, 14534741119463122035_u64, 14289859071102519527_u64, 7886626621831440768_u64, 214343628442599833_u64, 12857773327719383388_u64, 6273903867412424638_u64, 239482381323223920_u64, 13915048866709534313_u64, 397585037266148_u64],
        [1300629198021089073_u64, 6410952284051492499_u64, 4944582409384358976_u64, 8293487255973897035_u64, 3551156868283338382_u64, 464118696735590898_u64, 9312589010099424819_u64, 14324783720216522596_u64, 15558802309351310920_u64, 3917026958190033055_u64, 10142202528240835845_u64, 78765121920609_u64],
        [16670504229768440583_u64, 11628704163454411339_u64, 3412014715649042200_u64, 13088797519969559712_u64, 228450726932035034_u64, 12885538967311963745_u64, 5912375162023389150_u64, 13458196287643317248_u64, 13583329373618017736_u64, 7464138305448807682_u64, 11599009825219789995_u64, 231290296110081_u64],
        [16767202104167927747_u64, 1927275909687708167_u64, 11173921417605968695_u64, 16073319087287200581_u64, 17065362440009711451_u64, 10593171572281317414_u64, 5778320263599001354_u64, 9776604445890251265_u64, 9233437285305677174_u64, 13700466892872693330_u64, 10450697883551839946_u64, 156414555794365_u64],
        [9609213851784342668_u64, 5572422906149034440_u64, 14350503782984680084_u64, 12986369699717551032_u64, 16103168894432004559_u64, 2144500209512017556_u64, 8815552365322663541_u64, 4897285568648164357_u64, 8506884447185668314_u64, 11236508071800814264_u64, 13897013620965247746_u64, 119224843493811_u64],
        [2662907188614347104_u64, 13426112642926081299_u64, 14164293067512781282_u64, 1889814702841023502_u64, 945440364697522061_u64, 797235173446616541_u64, 337377967972685226_u64, 2524228885358865972_u64, 17404798993966930851_u64, 15759617934827310252_u64, 3546476801186047130_u64, 390418075211471_u64],
        [8984266835635973456_u64, 5301896187530335960_u64, 5449626417846049897_u64, 5075895614333901612_u64, 4056362996964433350_u64, 15880644519388964780_u64, 3066097506167134911_u64, 4272512246191411678_u64, 1457290475072391500_u64, 2972942269391312921_u64, 14957918197293814291_u64, 469039313446152_u64],
        [13161306545864008348_u64, 5644275999461284685_u64, 4435666771552202863_u64, 12856300246091336597_u64, 13574589140241218377_u64, 10792180080660918603_u64, 4330963405587210999_u64, 12384367630845569454_u64, 2420602918791797379_u64, 6468731576273913387_u64, 15559481846802341760_u64, 187529743166623_u64],
        [1956653057805784290_u64, 8916088791756283500_u64, 2140225853621681867_u64, 4570104305544089315_u64, 13447802656776006417_u64, 15901562339890886214_u64, 17590932253661784278_u64, 7189641996855050051_u64, 2228826305080056609_u64, 5741220480565576878_u64, 66598926328645428_u64, 90016805829276_u64],
        [10094345643411605025_u64, 7325859386407185241_u64, 10785259454390725153_u64, 15944817894205032056_u64, 5141368636582886339_u64, 1054196297206860041_u64, 6196344495449349545_u64, 8545952755322375559_u64, 18173348754009078442_u64, 7916429484225777040_u64, 13206650507919415782_u64, 480387288272082_u64],
        [6899963063027372817_u64, 10781966025894407338_u64, 17814161056583438785_u64, 8406132895973076903_u64, 1862701714777402772_u64, 678758195678069023_u64, 6386801261902730843_u64, 15528527258518526432_u64, 7079006600314014398_u64, 2028281826283968606_u64, 9589740691111347036_u64, 311755824435419_u64],
        [15840570149112193538_u64, 12503238064944925442_u64, 7721502227201540772_u64, 7920859099934337967_u64, 12683461364091882884_u64, 10779386801407146970_u64, 4106786780418267113_u64, 11674950222613563905_u64, 8236465110667595506_u64, 11736135194911196818_u64, 17246165261417001116_u64, 381539579702056_u64],
        [9272906598095368269_u64, 10865533242586558632_u64, 9787698038942966740_u64, 4883306931899293224_u64, 5277533539805861031_u64, 9570651814094877748_u64, 8492392755929765905_u64, 4950273297675582235_u64, 8983917836920163383_u64, 5554756453718753095_u64, 3338457800293661850_u64, 8022220151098_u64],
        [16563433224596471901_u64, 17774941243090648316_u64, 2998885358460244251_u64, 13982672805585450767_u64, 17811676623149359986_u64, 15823583417533506900_u64, 7709383085833237645_u64, 3946271232877871208_u64, 10510218618290238602_u64, 16635901590888985227_u64, 5053680096961385625_u64, 290522102411989_u64],
        [5538044189173248657_u64, 12707173569120931357_u64, 16845555985705610771_u64, 2783544206543984627_u64, 3183702819893690759_u64, 4290653158367698190_u64, 14981892532448041793_u64, 13492240905520675793_u64, 14185088022304271419_u64, 13685359344966057154_u64, 9628440109379129100_u64, 364985603212044_u64],
        [5983250493862154792_u64, 17358982219992130226_u64, 5202750593962549216_u64, 227892913468352664_u64, 8869629007460995274_u64, 9495677980777403000_u64, 9290219289525914306_u64, 11752732765813744898_u64, 3821421134039729748_u64, 11075399734786924592_u64, 4202240989296127694_u64, 233123846536509_u64],
        [2231360178999781351_u64, 16903633286679915485_u64, 13565862942198548819_u64, 133531300645592450_u64, 1355249930896194148_u64, 11066000178274380724_u64, 18408130810027694636_u64, 9664037010961858778_u64, 16284104782177924699_u64, 10205936494076119891_u64, 7469566071571866125_u64, 49652936346214_u64],
        [10400977186671847364_u64, 368544270551009950_u64, 15168872265664595074_u64, 18149325362502701034_u64, 16236995215715668509_u64, 5313686009220298233_u64, 1254894749008505890_u64, 13062648542448530244_u64, 9758598141966431060_u64, 6960483549075975884_u64, 18393171534052975557_u64, 293110817230578_u64],
        [12905005515475292177_u64, 12860579507610850719_u64, 703923003888527311_u64, 15222988816339491932_u64, 8299353600621921155_u64, 1839918352947845910_u64, 18110875705024908481_u64, 18435514717813076094_u64, 71208360690076260_u64, 11625683765840540468_u64, 10587340784119833727_u64, 230857373310385_u64],
        [10583928948264107658_u64, 11456158217373154454_u64, 3190510385353896867_u64, 17819618174984673341_u64, 14162158540876488122_u64, 14073107232772929172_u64, 14400393079873155152_u64, 9317591495206821266_u64, 11662096733534584936_u64, 15777087923989928436_u64, 9968613458946933632_u64, 392290506160836_u64],
        [325625052008367338_u64, 16653690879052648758_u64, 14830793699404733871_u64, 15710444103025342864_u64, 5984639347879158265_u64, 2521929967728926415_u64, 112871967496528092_u64, 720205617193566458_u64, 17171345062858335222_u64, 10343430972402524725_u64, 2096284005726730379_u64, 432080651408873_u64],
        [12760226510871442057_u64, 11329145521295786589_u64, 4565692419282610892_u64, 13409951327465119354_u64, 8485890294458701817_u64, 13396399611282678099_u64, 13923325185305917035_u64, 9290316283398167862_u64, 952844733786960926_u64, 9088158085244045824_u64, 10188684763205559473_u64, 398625915171378_u64],
        [13610697722363945944_u64, 4164396413974739050_u64, 13529932520925871038_u64, 4434268055909044916_u64, 4206279714994659163_u64, 4788736441197479185_u64, 2468954836596153328_u64, 189461329152158357_u64, 6085952599701309105_u64, 9703071974822133824_u64, 17910755807188273500_u64, 235597419351725_u64],
        [8150727828195558564_u64, 5027853961116250402_u64, 906091317535428459_u64, 14292636300398999730_u64, 9119478634019230907_u64, 14489965233908242156_u64, 14532376754489634116_u64, 16620959973133556719_u64, 1215484424528557953_u64, 8896878913813489648_u64, 14119643586495405592_u64, 135735229836358_u64],
        [3499873749028496640_u64, 14308538243389402863_u64, 8004523283030865972_u64, 7863178800272257039_u64, 4835059703625047233_u64, 1040485393920403612_u64, 1916981733690357020_u64, 17704893890740439744_u64, 10990767706405639111_u64, 13543987058014906920_u64, 6661254223101975521_u64, 324070218813385_u64],
        [14859380425038577122_u64, 5384703036874022927_u64, 9619622086919130083_u64, 12617314072933172479_u64, 11286966376131852750_u64, 7476706401771168271_u64, 16088213373070306232_u64, 11017867019937511501_u64, 10063169872841988433_u64, 5106161264681873040_u64, 9568087033776735516_u64, 248959391185843_u64],
        [14965335818370040632_u64, 7741050143317372402_u64, 1117239603228020415_u64, 15206770470086052688_u64, 15001805543988005891_u64, 18225854942821386420_u64, 9916166270525328444_u64, 14612694307455652565_u64, 5535673961371163641_u64, 8923998126601960802_u64, 4821859960551263896_u64, 38901842809055_u64],
        [9833746391020150718_u64, 5203810811369374399_u64, 601153789097231539_u64, 4869167669188531865_u64, 5833206199749554173_u64, 950071854047997516_u64, 11083738087445513014_u64, 7944867334184795409_u64, 5797811475666449973_u64, 9972095128549763346_u64, 4167120126524186753_u64, 431897070135879_u64],
        [11929342567091451852_u64, 274086348475746501_u64, 8364813215340662245_u64, 18339511716917626400_u64, 9045964092100827000_u64, 3236670039577096389_u64, 9923651413107259372_u64, 4821257584590012190_u64, 9629107846324857504_u64, 5652485009220098802_u64, 2393878330819079182_u64, 62585595743924_u64],
        [10108028481500596012_u64, 7084805878678991431_u64, 5438472779696581719_u64, 10537376289485887540_u64, 901076160974983816_u64, 3608633571853794934_u64, 12729398731647637200_u64, 5544625875235464589_u64, 11699824799667942456_u64, 16585243838399946450_u64, 12461516112668129390_u64, 367277280248461_u64],
        [18363254304559654001_u64, 18363010249316668443_u64, 3674091841252933952_u64, 12558657044086392819_u64, 4374419560896185869_u64, 16251186258179174088_u64, 8341321052562734184_u64, 9237327285121527737_u64, 11750608175575478820_u64, 12993490952249121888_u64, 487610523285865684_u64, 299710074698773_u64],
        [11403138967123324694_u64, 17487007200154717229_u64, 12725497199485703250_u64, 16637758471357860285_u64, 8529370881744329843_u64, 14611406454563356353_u64, 211220556406096406_u64, 8752516515504942655_u64, 3392761922426932976_u64, 2090813032119219661_u64, 567730104648275431_u64, 29555544923787_u64],
        [14811532430041109767_u64, 4890265744823594494_u64, 1885891725079968080_u64, 16725619415389412606_u64, 13065576713479849748_u64, 9983069245821744261_u64, 2634313417393056791_u64, 6433711950343505558_u64, 17883493467059976664_u64, 17845678504595409636_u64, 11364222739758146802_u64, 177720760445436_u64],
        [3080978561218663496_u64, 15406055079209387738_u64, 17743056999620355381_u64, 2946046535778132137_u64, 5203811459630032051_u64, 8139538248434706632_u64, 13599080563997639417_u64, 7089427644495784730_u64, 2815323859591063054_u64, 10164325463177684114_u64, 16131786972484096546_u64, 14751447636466_u64],
        [14426531753233295618_u64, 9007268986196597519_u64, 2194077700084403420_u64, 16458470075833248806_u64, 9312677837699139527_u64, 15628165982459429175_u64, 11125597286627465885_u64, 4976277689211067997_u64, 17746826672495224132_u64, 11426011762416855731_u64, 3153790262797302544_u64, 157545862977587_u64],
        [12793203832944434605_u64, 11203001665475694737_u64, 15233470643736890996_u64, 15926544730652662595_u64, 10316492269615074171_u64, 10415950457779158364_u64, 11344449260856405737_u64, 5920904633491315208_u64, 12455261907161187445_u64, 2757856359275781017_u64, 8122116723794089111_u64, 219085208491646_u64],
        [6487105056058947947_u64, 2943011582042622822_u64, 1234206293954881492_u64, 4629498682622054897_u64, 11319312284933637949_u64, 13587122075891576482_u64, 7474499279540588549_u64, 156061812361035356_u64, 7476662136488088090_u64, 1302005302328625034_u64, 1163098450579419543_u64, 203501712890982_u64],
        [8687813640176873687_u64, 5686707714410503395_u64, 10573129530306090676_u64, 9195208802665065463_u64, 6347813461595171236_u64, 15051590198498678737_u64, 8598712211856837442_u64, 276446386216689632_u64, 6287472470316936683_u64, 11746851209206539095_u64, 9196988440473901221_u64, 141366210833145_u64],
        [12652581388906133982_u64, 5058082717556623589_u64, 13512573413453926355_u64, 10547567576366548819_u64, 6704987697431776395_u64, 7917242202277217642_u64, 4982043994358358604_u64, 11549996377318212345_u64, 1011997075020033920_u64, 9096455215384525033_u64, 9355871324912779954_u64, 220574564742701_u64],
        [8300337954717020369_u64, 11047665387686693187_u64, 2109736857499350071_u64, 2421477255582683552_u64, 16953151169557991087_u64, 11632086118048857489_u64, 5061030654129147161_u64, 1252622440351436520_u64, 4336829479313125239_u64, 12025514026223018578_u64, 5466311131404573773_u64, 497725166818902_u64],
        [309779510786606509_u64, 4844830405667179379_u64, 15296686029625989167_u64, 18374322512404267706_u64, 9703482488944977765_u64, 9926836267288194389_u64, 6215496190819010290_u64, 13214767959180305102_u64, 10024025221331257024_u64, 4267804901381275199_u64, 11052908240598546270_u64, 269756106437470_u64],
        [4206712679288869634_u64, 2735466474607120272_u64, 6525539693777831388_u64, 7698312366693864803_u64, 5947071406644633934_u64, 12934030485823414492_u64, 18356014181473490211_u64, 14334884446448422832_u64, 12530623967605517465_u64, 12097453858626269798_u64, 7093886943205498768_u64, 367520664054330_u64],
        [11790992458432298355_u64, 3249958246085904144_u64, 9508842240041174559_u64, 7951385863566214049_u64, 6319739988769674555_u64, 17696026921774256248_u64, 11868248330123087075_u64, 9523052618582108364_u64, 4300948988339702937_u64, 6458725249530084722_u64, 12615129308283869479_u64, 19718976968494_u64],
        [2426723505637871517_u64, 7074349819993032319_u64, 16257522823206788182_u64, 2052127710835480036_u64, 3759220799200699486_u64, 12465158246520564948_u64, 10977821257334939272_u64, 5162831647483948041_u64, 6016041364602513348_u64, 9693621735981731518_u64, 5428919010899080541_u64, 246661456290191_u64],
        [16085727236956597306_u64, 15916757089681174294_u64, 15804314991646536091_u64, 8808269290273366608_u64, 13826045660091997876_u64, 5193441498092952107_u64, 12877941958610345664_u64, 9216488629989118432_u64, 5875916544577292942_u64, 15372597613382937228_u64, 14432461466198591291_u64, 320561919273242_u64],
        [13995345145822948255_u64, 11256665109720437711_u64, 15289892509806359750_u64, 9457606447700628634_u64, 15414465511324473200_u64, 15231461724956222993_u64, 18316522682832522343_u64, 3308407760593768578_u64, 12141483431496006744_u64, 8940449154051013673_u64, 10224649270362798376_u64, 458513952587631_u64],
        [16571004386121516864_u64, 13022040223286872762_u64, 3412441299844461934_u64, 16207369174644022944_u64, 13835543996769511565_u64, 17766852669398838344_u64, 8754019339150722286_u64, 1639653364865847550_u64, 5287462346444088796_u64, 9353726487571393352_u64, 3374261141609202796_u64, 310620978239068_u64],
        [5718871399477305464_u64, 758851421538655637_u64, 8669283990575754082_u64, 13095946591619921621_u64, 16432089744504836107_u64, 5517671227542775625_u64, 1793090947141057389_u64, 14126784952728375684_u64, 15899287754871089671_u64, 662658272273072935_u64, 10558400335851140722_u64, 322372645504241_u64],
        [15759265617454336805_u64, 5889795645294812434_u64, 4773301145094084642_u64, 2567462338745994403_u64, 8592070419796324640_u64, 3542834981079610861_u64, 3805812626137371203_u64, 1967478668510558228_u64, 13293049070324488442_u64, 11379773056995257839_u64, 6955203852193008342_u64, 162008711634250_u64],
        [1264705637848017017_u64, 9690523563754154856_u64, 10728737372697751103_u64, 13918186587104962172_u64, 9311765762645354706_u64, 15981714843285994136_u64, 10403283812777849117_u64, 15107529082339304785_u64, 782945236553054456_u64, 11292238925664070210_u64, 3675871692273185467_u64, 337406031128096_u64],
        [13651818315139129592_u64, 5055184668349047021_u64, 5555145630212243345_u64, 9412172028020767080_u64, 1895338126060062354_u64, 3843682718591941584_u64, 6100956129238248920_u64, 18135089591857248317_u64, 8917409484191869472_u64, 13271588668624145329_u64, 9470395478082270033_u64, 32766251770340_u64],
        [8559105385645381461_u64, 14455262485315338970_u64, 4529679006090630587_u64, 5665323839528324108_u64, 2585687714660198569_u64, 2709257262885614387_u64, 9166177500923679904_u64, 13712462331581396824_u64, 2694904331679600425_u64, 2507804707144395928_u64, 5910239895296609646_u64, 271871984017181_u64],
        [12195991539521880758_u64, 4613940300639086098_u64, 11642483356777412987_u64, 63934360637248373_u64, 11788383213084240343_u64, 2212193071223863931_u64, 6583440177452290684_u64, 2498835463184240273_u64, 2747286481641279338_u64, 8102336597494169291_u64, 11934581210966433913_u64, 384382868532121_u64],
        [612241915949712363_u64, 1944325172397029251_u64, 10176728471593978448_u64, 6445046166792335955_u64, 5614853535969465934_u64, 15547091651982077497_u64, 8499357185043233695_u64, 15766516673063843470_u64, 10697214412159380795_u64, 1829152987871626983_u64, 13977306161258991638_u64, 222614518360076_u64],
        [13173413335987542458_u64, 8573139239528451811_u64, 697476405391042902_u64, 15506314111594744393_u64, 5403988350633284922_u64, 14785238867834582830_u64, 5894879960394837494_u64, 7341981028782440230_u64, 14993954173015518115_u64, 17394620094566316489_u64, 8908980247551650086_u64, 264131073282381_u64],
        [8705977524166724866_u64, 17035213662558400981_u64, 15049619280272511707_u64, 14231138392801959073_u64, 10913745597089602494_u64, 14692027061918212942_u64, 15799556184737717142_u64, 8727265419258390059_u64, 17199545172283964699_u64, 8052505974545021794_u64, 9150186020575799486_u64, 79550925510741_u64],
        [13045938811153358283_u64, 5304123933522859097_u64, 3552049002123447644_u64, 17961941273678150027_u64, 9688937518052312674_u64, 15505491516973968835_u64, 15653506550330108311_u64, 2427243217092159571_u64, 8887704338829169390_u64, 14798673689575864240_u64, 4176346260301664627_u64, 461820459389130_u64],
        [7812588972706171221_u64, 7625378051081114345_u64, 4498428836866966781_u64, 4237596015895741496_u64, 6204104954043584822_u64, 3883059410324928656_u64, 7326805803584156579_u64, 6036050185203594822_u64, 15594365415191915980_u64, 7827947742658301840_u64, 6965753253933813772_u64, 119094213604374_u64],
        [16973906646690685195_u64, 11652741029244957021_u64, 15312873427226261361_u64, 11089513295491967392_u64, 15211577631860316527_u64, 15908136899813015076_u64, 12810373998134751396_u64, 17439730987997786542_u64, 9471087890007828724_u64, 682964137919207084_u64, 14158739107716137871_u64, 262711474756508_u64],
        [4995029625987070144_u64, 649087630254206149_u64, 8039928464579595066_u64, 6165718434667558749_u64, 2158520453908212193_u64, 11630791233609847944_u64, 18000137045655799175_u64, 3640980971101462188_u64, 2967881898948511559_u64, 4929084596526786552_u64, 7487209173117166662_u64, 158796032016639_u64],
        [15415633558442445943_u64, 5359247420199303601_u64, 16906907947243750470_u64, 15850565529439910745_u64, 6431166631286517888_u64, 4521190703787314993_u64, 6906911170205496754_u64, 9199169922860948492_u64, 3258542038163991671_u64, 15345864087612843853_u64, 8897569282675881472_u64, 3147429186760_u64],
        [7842758347273522775_u64, 4235101264152427056_u64, 16597825964628506233_u64, 14725748089750251315_u64, 6619013741225740232_u64, 7319022087206534647_u64, 3500733449572685430_u64, 8645881368665129434_u64, 4884186863480052480_u64, 13872564313563830756_u64, 5487605445101552881_u64, 128773742985040_u64],
        [6689021291112736202_u64, 6839862686250989133_u64, 12986757481205269665_u64, 3623078347798407484_u64, 6095124822859294954_u64, 4843071558746925318_u64, 4045640826290312805_u64, 8780899977327437262_u64, 6050175354326752739_u64, 8801765438555135319_u64, 17938886193568574112_u64, 250689392739512_u64],
        [14119106377517785560_u64, 1305489663952550940_u64, 814962800636704564_u64, 1827223971214713300_u64, 17147116364504021904_u64, 4520109679356469961_u64, 14237760962192254349_u64, 10950213416803360609_u64, 17530578114722406014_u64, 2416437281875491240_u64, 12197892089068143902_u64, 407135299108952_u64],
        [10454815454854599894_u64, 8607958080262946317_u64, 10317281001260679818_u64, 9971357018116233352_u64, 9740404038303971966_u64, 15505366707372940145_u64, 9155775100643915088_u64, 8442037659610006592_u64, 4146122930014292064_u64, 12103825573843939196_u64, 8894966105285909087_u64, 334090165283_u64],
        [8482033640091036620_u64, 12431033236538929944_u64, 5771829535459317921_u64, 16337592326132344521_u64, 15253505613717693566_u64, 4162420703991957652_u64, 3997240601437621265_u64, 3359484453234838951_u64, 3619326568279126698_u64, 6412757530025316209_u64, 13869070054084295132_u64, 327667593886021_u64],
        [879135318174402835_u64, 18091287099749133273_u64, 2740934292428980739_u64, 18070370592271315071_u64, 11232394248249618805_u64, 17888678529011424365_u64, 288371901863082186_u64, 14575197123575172033_u64, 18131369155033670926_u64, 7836828111889599989_u64, 13381730247902821654_u64, 278771915125447_u64],
        [2189860522146490132_u64, 10296827124149688343_u64, 6821539934833847422_u64, 459975245522725563_u64, 12797632015939963965_u64, 5790550836105043847_u64, 7094970789589595054_u64, 12077391586958683318_u64, 6966741472367207644_u64, 5132371183712246055_u64, 1707616732224740342_u64, 408037231820455_u64],
        [3453378544703708763_u64, 1218010217421853432_u64, 15563525683469010847_u64, 2607902147663275894_u64, 13278121045659675887_u64, 685717725168725213_u64, 4185426220003380568_u64, 12367611801850494059_u64, 13591727142693333840_u64, 6933943475845368498_u64, 7816284809810013790_u64, 197530113009156_u64],
        [14727648369557136383_u64, 13294333013876239666_u64, 11946032178884699491_u64, 13482620784550994010_u64, 15705147799114409380_u64, 12558764981876033470_u64, 3414204444265621077_u64, 17302399144369605279_u64, 17837098825566440969_u64, 9091919366351349198_u64, 16902224844108651591_u64, 445505485475961_u64],
        [8765945934200428870_u64, 6166565000716580493_u64, 12825069280350441563_u64, 13614090588646188847_u64, 4902598567554537597_u64, 7053586068717928020_u64, 12718786082046970743_u64, 17269533355838264460_u64, 4874045757231275049_u64, 942214425393739875_u64, 17777432749361867290_u64, 341757172828527_u64],
        [6094805601317076456_u64, 12500512290213295544_u64, 7436435280410980068_u64, 6824312118422455224_u64, 1452463277419391483_u64, 3019776714664036754_u64, 10121191474913555129_u64, 4841394747484004034_u64, 1346303745523483162_u64, 15468467231385140232_u64, 15643809064229795934_u64, 34387830917721_u64],
        [1045593047926170262_u64, 12267062775700359173_u64, 4499471295826801980_u64, 14348727053443485970_u64, 14503166804808912749_u64, 13298270208135726831_u64, 11723110944866775464_u64, 2901753910418613877_u64, 12046131780681617055_u64, 3334313951548903971_u64, 10924287416726598376_u64, 179151477337790_u64],
        [13082499760965838421_u64, 10456322314086876057_u64, 10822855176596300414_u64, 15046745464636893124_u64, 14856015816896402164_u64, 2438584460077992877_u64, 9884230570389097154_u64, 5375915013943675552_u64, 840957770789393679_u64, 13208374272341556358_u64, 1207669852785726920_u64, 271035879239013_u64],
        [13212862456580833663_u64, 192006329829397936_u64, 15891907236883901512_u64, 5483200205034001235_u64, 16913014862829973939_u64, 4513671334505759731_u64, 9495995106506128038_u64, 8200763218840650688_u64, 3999400785126578517_u64, 4054116291678779125_u64, 6315291865687977029_u64, 203863561950843_u64],
        [6405312183043633618_u64, 3149809223117378724_u64, 7461973867897774415_u64, 4517691081329949271_u64, 12764159367570473363_u64, 11363594422060465903_u64, 1588330619586256798_u64, 14292062314519562783_u64, 10899152670735789330_u64, 4785722449846898497_u64, 2712474632901206722_u64, 392891720443831_u64],
        [12415557073781041338_u64, 8528447153226372986_u64, 2154927904036718147_u64, 3338339282647912044_u64, 18365795325268664587_u64, 888132785592606940_u64, 5196888427103222260_u64, 15251684659646386381_u64, 18263978990693767165_u64, 13761876740659485047_u64, 17296827553906134233_u64, 34834304819949_u64],
        [16735965317015203281_u64, 11781169383181002839_u64, 13210222686911650601_u64, 2661498510720392324_u64, 18351075021388079919_u64, 13402761656152894427_u64, 7295494378064181942_u64, 1127669922840379382_u64, 3157740729275769013_u64, 8922080242367968531_u64, 10232139135579592867_u64, 463518865051874_u64],
        [18052033252943587508_u64, 13801545566906034605_u64, 2879163823429883757_u64, 11118114597710202100_u64, 11227795557040509529_u64, 14288381364192331199_u64, 14996252323659299193_u64, 974127101662745689_u64, 3874325513345330460_u64, 11912348774666535793_u64, 9383516556271302421_u64, 453140775651916_u64],
        [8925365851055253822_u64, 15425620198250413235_u64, 9985782699364705254_u64, 12205552555520719607_u64, 17699615926528335089_u64, 621836954547527795_u64, 7141572009445905175_u64, 10131612416590158919_u64, 15627039259743854909_u64, 10534006220351875088_u64, 10367748824386819467_u64, 75294318710902_u64],
        [15376179406924584_u64, 4240973101699550448_u64, 9277342190207982900_u64, 407977031134897611_u64, 14030140601741984965_u64, 126273201913586092_u64, 10663346293988481604_u64, 15296297619111051641_u64, 106978609154610882_u64, 2218709013760452423_u64, 14280747389999674949_u64, 432724438923311_u64],
        [5208995474772627456_u64, 11563530544331928914_u64, 12920115064248390536_u64, 5590545988929935461_u64, 9948521967917663224_u64, 2241751779926801959_u64, 5768474345382812706_u64, 7305671900661344462_u64, 347673795605839709_u64, 55403837638547246_u64, 9410521601374865295_u64, 325916778859937_u64],
        [9954174199765553443_u64, 9563876355607503061_u64, 16094691605779541155_u64, 12530942111217894057_u64, 1579113849427645530_u64, 6056670162564778416_u64, 1468124647661282136_u64, 6342386697945495545_u64, 2198108209015986949_u64, 10776878888231234438_u64, 14878949078807304701_u64, 201447453701596_u64],
        [955497969070269841_u64, 345875785050788191_u64, 2102919434608770283_u64, 16726607519028560163_u64, 8811028124817836294_u64, 15129615818366963833_u64, 1940733664332406076_u64, 1150593138129603902_u64, 7371337121419954386_u64, 1645215140690841220_u64, 11206913086192527995_u64, 51366617767300_u64],
        [1556976903087811600_u64, 7516538931202102346_u64, 731892064513987013_u64, 5458171683077759789_u64, 14820034262819903708_u64, 12476008013174826625_u64, 12466165634696225618_u64, 12385521334472330674_u64, 9415578299650033083_u64, 9480999377717235900_u64, 16383726196686261455_u64, 237712003334090_u64],
        [97749691935554002_u64, 13684522591102385754_u64, 14952274172582301673_u64, 11850543648706493055_u64, 1326831196121707416_u64, 14971510277880136557_u64, 6363070332113474035_u64, 2089730884341063374_u64, 10289507634713400075_u64, 10534770870423845801_u64, 12717123134987058503_u64, 198744238004915_u64],
        [17972560377734369698_u64, 9108025043927304032_u64, 17140106872907909839_u64, 16236559236974494882_u64, 10884383997142939883_u64, 11746386671451961792_u64, 10845161609205194534_u64, 2716039569863149132_u64, 15435508397402550787_u64, 12398966286476443608_u64, 14442900975902925715_u64, 105616573440812_u64],
        [17435118918434526501_u64, 17658943682592488920_u64, 3796826785217703905_u64, 18442693076565806466_u64, 13167277009484267951_u64, 11139308766309291831_u64, 1625828469106604055_u64, 14426782401660423836_u64, 15700276570145678675_u64, 1033898797021544779_u64, 11550117322992194608_u64, 356287259064841_u64],
        [8787366082334541828_u64, 13503723167337291655_u64, 4142460103976716479_u64, 2106302393658431009_u64, 15469517499459856194_u64, 3030468522402259789_u64, 5975287541466851753_u64, 8046798764641924276_u64, 8013149581581951516_u64, 1767899357833632386_u64, 5454974196671812831_u64, 111540405158699_u64],
        [8932970427162977019_u64, 4908671541391993162_u64, 12637555759183337537_u64, 2056148298822280621_u64, 9248612790229863136_u64, 5885333219174675924_u64, 240025624181187584_u64, 13925447322555917911_u64, 13986038804164182132_u64, 17567298894140610744_u64, 9514722966537751657_u64, 342825506021068_u64],
        [15285562957719657418_u64, 11601920301698357965_u64, 18220885407371886910_u64, 8221845048057980716_u64, 16705621293467719163_u64, 136391843589262025_u64, 6638160785913741431_u64, 4829516639051234283_u64, 11451412900974610646_u64, 5961247168442288590_u64, 14885163120706694482_u64, 343741512738355_u64],
        [4795525808960920360_u64, 14260767218153605969_u64, 14591054969636545350_u64, 4630997151775028036_u64, 10210047127845069879_u64, 1917981412438718953_u64, 16663171735053852483_u64, 17658361836686394852_u64, 3348313891846207849_u64, 10740255676404929789_u64, 14902834274122624713_u64, 258638342014869_u64],
        [16131484550591619296_u64, 7551804461933850097_u64, 11639731435810406739_u64, 1691010406307172066_u64, 611363284052100848_u64, 8576357268185952291_u64, 14673459094051432569_u64, 5506766257348639305_u64, 10535538198779371593_u64, 4552259746237336849_u64, 4753578264217841784_u64, 315208609893501_u64],
        [7611556916820672414_u64, 17118829096864066915_u64, 7196745905311108439_u64, 5277520325805924168_u64, 5696659651549652134_u64, 10490007708405088124_u64, 5282866832640383940_u64, 16462863878051733969_u64, 16045185550317875168_u64, 8056030492729981441_u64, 5595067671114570851_u64, 213949294944889_u64],
        [9699192301041201006_u64, 2448922309634867893_u64, 2961460816617364237_u64, 5769224530696881719_u64, 6736312220397611974_u64, 7941312464164293038_u64, 5857232536418986682_u64, 8621340908249432051_u64, 5155676443370983366_u64, 3613254508167628736_u64, 6228826831603124490_u64, 372856162049156_u64],
        [18286142342893567050_u64, 15254475714687231252_u64, 12717175880462332249_u64, 12232368697022725738_u64, 17072964851368142007_u64, 10132567277814289416_u64, 2245647719762623201_u64, 18351560974409398539_u64, 15495634742680818108_u64, 6499224830941790199_u64, 6309619335882804335_u64, 159063280726023_u64],
        [15186827785917775075_u64, 14552533066055732727_u64, 2713236691087053988_u64, 2932662703379731649_u64, 7689055279929992162_u64, 18094501209338110708_u64, 10666686600657240258_u64, 17681842737730188436_u64, 8990566930313195902_u64, 18143808288594212758_u64, 9251011999747402466_u64, 44887320100708_u64],
        [12781644110795384_u64, 9479803500791824361_u64, 16710622967402956497_u64, 18119367577576540334_u64, 2643612557092621259_u64, 6678594584589917394_u64, 14719716814279974609_u64, 1812929131752119504_u64, 7511470095224357783_u64, 1219428200690443183_u64, 11682085088246744385_u64, 492502390146703_u64],
        [6638600424669051076_u64, 10925701404280367802_u64, 10468550792287481687_u64, 3894701162242524257_u64, 4171993828995413850_u64, 14891623023226969182_u64, 7705951318183339813_u64, 7589976724882428449_u64, 17434722992087821326_u64, 12300379103039025979_u64, 850925062624222582_u64, 469088461878063_u64],
        [18102076298168245197_u64, 4073572549185741520_u64, 8402119417240444202_u64, 12151720744102942684_u64, 11061031317025447076_u64, 4521510133168888776_u64, 17507087828932877762_u64, 9441436435552744797_u64, 6243578959897067498_u64, 11818216235515372655_u64, 5896793228850461462_u64, 175746743148191_u64],
        [3540093229295316309_u64, 12417490092482425707_u64, 5257852967936814087_u64, 4136999510338900481_u64, 6336369879714973430_u64, 2857161484688010182_u64, 16897862557388961443_u64, 11638188074209272754_u64, 7675530926470293097_u64, 14174601294786878418_u64, 2192011279436347757_u64, 25817679414936_u64],
        [11084663101100124959_u64, 7329547253365605782_u64, 9478069439550446067_u64, 11686412253977559988_u64, 1559207498295891654_u64, 2379645143166520314_u64, 5722888122807604343_u64, 6301901010474777856_u64, 11988415381265587859_u64, 7707879042395092912_u64, 16725969244089578398_u64, 362899868501820_u64],
        [1689746488009939665_u64, 16375080811083129306_u64, 9396136871130251100_u64, 10416465207089619205_u64, 16100806548771839434_u64, 8082494784872774927_u64, 10377708402843750239_u64, 787980066099429044_u64, 7229228996470461799_u64, 409571830751091768_u64, 9711982467193750750_u64, 481980595776783_u64],
        [15151400538202391092_u64, 5098104356646254820_u64, 9708083724185159225_u64, 5897088922173394037_u64, 14879634388821162315_u64, 12125930423752127155_u64, 12044240206313152156_u64, 2776319995536986933_u64, 16491286189074359935_u64, 1463666902086783624_u64, 8329982162071208529_u64, 448632825950525_u64],
        [11730806481465435562_u64, 17385119716840558048_u64, 18378141059553544804_u64, 1748409850981591001_u64, 16293937356927854605_u64, 359463752961328917_u64, 3058189486278857457_u64, 9644131008146757674_u64, 3255092259206703415_u64, 3181786939338727091_u64, 2251865130195734691_u64, 409955917115389_u64],
        [1001429940018917422_u64, 12160189634667399180_u64, 10103100785564704840_u64, 11844534639052438744_u64, 5809185829365027376_u64, 13578978407909749299_u64, 9396908815040546999_u64, 7370613564733668770_u64, 2165588146322362501_u64, 18345824401042240591_u64, 8574257765176899020_u64, 458608518073911_u64],
        [5220318286200565390_u64, 2166894363423511008_u64, 4116771816257216009_u64, 7155995685885916550_u64, 10277135145578608865_u64, 6263432675423737639_u64, 12443258826886366156_u64, 9669755290564958750_u64, 4320052667900885052_u64, 6516959806045511170_u64, 1617389991503311681_u64, 33621029837881_u64],
        [5438083393516198372_u64, 1312188905927184630_u64, 7301724622875431944_u64, 2795292180751914307_u64, 12971300273092585444_u64, 6153327169516665295_u64, 1600934421497113429_u64, 3357928526517550527_u64, 16734548329777494895_u64, 13432330469132924156_u64, 13491288341339526972_u64, 87872152241309_u64],
        [17702666552516228757_u64, 17575397825097634865_u64, 6870639560472004003_u64, 18121520151271580646_u64, 11770762176451890072_u64, 4559205973865030779_u64, 15257307253233657947_u64, 13348358404945523705_u64, 17498395567892302556_u64, 8645654632321419044_u64, 17440797608307304735_u64, 49543947981755_u64],
        [9941771417884718672_u64, 431235011350890915_u64, 368542457922336655_u64, 5210313525941220419_u64, 13795236441268930146_u64, 3445891015668997008_u64, 9759958963010171115_u64, 14039411569363874255_u64, 1561827280625809775_u64, 11402789447034997938_u64, 3760224816378964021_u64, 439186049683512_u64],
        [9419942331449128878_u64, 12022818631613571582_u64, 7060612536730770454_u64, 3989826550630725785_u64, 2373342533320281318_u64, 3496515581322685482_u64, 1284195839727677596_u64, 6954117329532634413_u64, 4382258544309737533_u64, 13057281209994636117_u64, 6926515897559520408_u64, 203589565903997_u64],
        [9284858014606368631_u64, 16649258581900219525_u64, 16108769835239214929_u64, 2376884009164751055_u64, 7797315680070717733_u64, 13131881361953293660_u64, 6500043135069583543_u64, 9989658391416539876_u64, 11897468497913848099_u64, 17107442373926812982_u64, 4324577825413599056_u64, 472485751683760_u64],
        [4274080220182017580_u64, 6399385726954523298_u64, 10150998924250004021_u64, 18264648534446197014_u64, 522398248901508667_u64, 3169549865475630773_u64, 7423938716559188651_u64, 966958698986999866_u64, 7289085428167104355_u64, 14384293059259636240_u64, 649502080732001633_u64, 460981099607326_u64],
        [3131948604245395257_u64, 14385810648708111487_u64, 7776568482397371752_u64, 17812421919615482001_u64, 3419982504347127329_u64, 1539026191642915177_u64, 6303168349914876907_u64, 14920323276176872478_u64, 1943526415886180730_u64, 4162063100447052696_u64, 7483794451993496407_u64, 469651985769192_u64],
        [5914881157288698900_u64, 2683319654494588778_u64, 10289879319840076983_u64, 5355638151646866404_u64, 5704012093469111266_u64, 17038797261900266418_u64, 17157502988707327138_u64, 4395575122996733815_u64, 12680436694371058337_u64, 10432522260580851802_u64, 9643039520012228302_u64, 247869516630249_u64],
        [9938378716262445701_u64, 9661041534249931559_u64, 2416567376091204205_u64, 2142647660897339685_u64, 14432103743874959904_u64, 9830346347882434318_u64, 9883285707830334515_u64, 6702194381791642535_u64, 8065360188136071095_u64, 16533461884604055977_u64, 10711885032048817796_u64, 483322847500455_u64],
        [17916664161830588569_u64, 14079200107978187162_u64, 4530086904657577514_u64, 8375638411154592942_u64, 40739608567211898_u64, 16583417686058438543_u64, 6763220146265249244_u64, 5254868598149254984_u64, 16535347487084113415_u64, 7446658396606498483_u64, 3333383956989752837_u64, 178678318400370_u64],
        [16849695878380750673_u64, 10527675427855344262_u64, 2005965223941119099_u64, 14656613291937824803_u64, 11530504464679042174_u64, 5097973892271280480_u64, 16299803799861234679_u64, 17315537510120859467_u64, 600623678040706863_u64, 689580453659545514_u64, 13425399509389353511_u64, 371750600499999_u64],
        [17413511451461433493_u64, 15685403581252034557_u64, 5238510028814455087_u64, 11921431733944878896_u64, 14629457051351287831_u64, 18358063065742179269_u64, 1262496702447468167_u64, 1457226239916053778_u64, 17134937139523961781_u64, 15342820435237098657_u64, 7459750960995327691_u64, 396145639277732_u64],
        [17369087537259773062_u64, 6208471570030323565_u64, 5906973306885104053_u64, 5927082028952176403_u64, 18033935909240944398_u64, 18068724104603661088_u64, 6064973655977792165_u64, 4314304493141719872_u64, 11575158848183586237_u64, 18169809289627565728_u64, 4368724121484295953_u64, 385036232285191_u64],
        [18363844117740084297_u64, 16072337317082903714_u64, 3811097351016049943_u64, 17267257868911151469_u64, 13256040746096069583_u64, 2776868514140718125_u64, 15636955221594567279_u64, 10213389224562847655_u64, 3975105351810243342_u64, 12454696929872836288_u64, 2567626924848436455_u64, 345435465626036_u64],
        [14841153342648292587_u64, 1015788491010046071_u64, 13919837978852342409_u64, 4853972668886781075_u64, 18438956424567707060_u64, 10881742419960670050_u64, 266351128987991685_u64, 14342207121307610481_u64, 9782646190305680241_u64, 13391221896268428590_u64, 12170044754756907874_u64, 390745605981978_u64],
        [57916289323749588_u64, 5610785515325057330_u64, 8183999522054066457_u64, 695062631438763727_u64, 3433072006449611010_u64, 17102595162037838313_u64, 13080078790024564836_u64, 2993408362991019514_u64, 10051777506344296535_u64, 11134842571023404863_u64, 13713097892642377104_u64, 353530295478720_u64],
        [7089351990260449290_u64, 7525160589474909796_u64, 9945070309429402750_u64, 7170591292455681675_u64, 157676726545372174_u64, 12619894428036127555_u64, 9966682981674850676_u64, 17533134322602443601_u64, 9655218613538993843_u64, 2142543096591550706_u64, 17802154267834013697_u64, 131658688544508_u64],
        [3693675037487157411_u64, 6700359275292598904_u64, 3197299900998321768_u64, 11993547162832931740_u64, 867432313894815955_u64, 14349163869919331282_u64, 1451163414215727173_u64, 17460173731639845402_u64, 18257738353934578179_u64, 13191663198971193174_u64, 8622077823600811702_u64, 358343229604026_u64],
        [3268851624942558546_u64, 5936402291546551241_u64, 9530913090447394159_u64, 5964198422360506725_u64, 9892451243174969473_u64, 4822142174687449769_u64, 16346420150044127626_u64, 9173276694846059891_u64, 17657678400220127438_u64, 372768055711487808_u64, 8516154388946699170_u64, 253813026487390_u64],
        [6880980967874823347_u64, 2936854559917286531_u64, 7663214219430761524_u64, 10202719770961486921_u64, 4448412961298939835_u64, 8476680070501585177_u64, 7112817390476754130_u64, 4157918034024340081_u64, 16608130956274109475_u64, 14078971545927141389_u64, 10760596773814927597_u64, 67802998451737_u64],
        [6291675674584206041_u64, 4833578459868045645_u64, 12795465760550044077_u64, 5397806811637360770_u64, 30015450773357243_u64, 13755824798461929770_u64, 2344698506226142150_u64, 15985371718054554270_u64, 29724836184999868_u64, 10674199087030060499_u64, 17176180636826515052_u64, 287280364072844_u64],
        [2258182051008862291_u64, 8261178021578857354_u64, 12442881449507014880_u64, 18434916325320065586_u64, 4430147139787389243_u64, 9461307302670845175_u64, 16250959603441324742_u64, 12817703089637468504_u64, 17400320065173015810_u64, 9128214677131135879_u64, 5724600834499958020_u64, 201918979249172_u64],
        [9047390865790233114_u64, 10427996945655573194_u64, 5746843339755170912_u64, 12114017861791086326_u64, 15020368092789606494_u64, 13819118506306959188_u64, 11015892817639382699_u64, 9870437848544135191_u64, 17184042936512633498_u64, 14387039897542116716_u64, 6680608458576942493_u64, 150416572889720_u64],
        [15747428268727969562_u64, 3087473003236716278_u64, 1379497430099653973_u64, 6063057042584870557_u64, 16991495724475537262_u64, 17281938609279856060_u64, 13000137747343883913_u64, 1264706941922698557_u64, 2866659005222206472_u64, 17960099144510601844_u64, 1379406877598206551_u64, 129529558386967_u64],
        [18344156595633023148_u64, 3709933848682621183_u64, 17194849697333311608_u64, 7134586049955611415_u64, 712588035630331286_u64, 15784143547297385836_u64, 16072243061979338944_u64, 2724117502764143432_u64, 1920908168656192193_u64, 17158747727004522593_u64, 11528956987598058845_u64, 219141376465111_u64],
        [2756333845211477676_u64, 12081611994562164477_u64, 4787950834624773129_u64, 3345489745118325405_u64, 7009720248843855990_u64, 11768218081233102003_u64, 14455393893003276062_u64, 6058323144870450970_u64, 10292642518775130859_u64, 6012038335433687223_u64, 11765901782055014117_u64, 158100251485187_u64],
        [1617831477718483293_u64, 10683190903399026678_u64, 15743438350003534173_u64, 8857585604111152198_u64, 1438624279092419783_u64, 10082971914881184603_u64, 14554229242928345622_u64, 12012996926679081568_u64, 14357307866364376075_u64, 7867045578337761326_u64, 14306749926936822351_u64, 143076621477028_u64],
        [11289597467871955553_u64, 17216630712277240412_u64, 503343822586713965_u64, 1406943907349503763_u64, 10397153793802812701_u64, 13150272411924829655_u64, 4526904397754515354_u64, 15407267653074346687_u64, 11314378020671821719_u64, 4570591021824349020_u64, 12323312412232159295_u64, 468831769464627_u64],
        [8201504765826107588_u64, 16718990209695127868_u64, 15494374875249248027_u64, 3125104708273739679_u64, 3069255932886096135_u64, 4312002337259374016_u64, 6370058970138900256_u64, 172468577036558144_u64, 13385686622136021445_u64, 7018674736335651358_u64, 17200169860905721450_u64, 352900885400942_u64],
        [12320869618433264520_u64, 4820287345971054361_u64, 4737775578681320764_u64, 3426897659674971261_u64, 1484102314366965349_u64, 11895440569042833793_u64, 10089460793381375532_u64, 16229643368355000686_u64, 4106510951714180279_u64, 1204754638874070044_u64, 16880303684304380066_u64, 334010638168071_u64],
        [11939760436054192695_u64, 16311484860334454989_u64, 18136362967321225411_u64, 6621563739844886377_u64, 12151892317034052790_u64, 12632235346149553646_u64, 13252521600429143000_u64, 14758626126137339872_u64, 15000157464713110468_u64, 8755142062181288822_u64, 16785660751335548334_u64, 244926680934224_u64],
        [4193774014934534860_u64, 8115374668141018547_u64, 4147046082597488549_u64, 4721064545338017259_u64, 15854493190817182999_u64, 17892180721913208479_u64, 14979535998527871982_u64, 14912964788141412898_u64, 2848062445990612337_u64, 12298185267743824571_u64, 4761197042549642799_u64, 437629808143932_u64],
        [8488795632172609018_u64, 11460950772487364787_u64, 6211219713716084228_u64, 8502324475108736941_u64, 855333307465575405_u64, 3870224469370732766_u64, 12794607799915521429_u64, 5941245183665224_u64, 12110822812579065181_u64, 1782123833822113251_u64, 14183487246293467888_u64, 266015092144499_u64],
        [17590681854776643430_u64, 110545389037077936_u64, 15878702406297844777_u64, 3053695032723420845_u64, 3837040502475803404_u64, 3439321026530907000_u64, 11428470206248538220_u64, 17949344108412207710_u64, 16922865156443827702_u64, 8797308860412635542_u64, 5320482361471611225_u64, 253801876851526_u64],
        [11382806488784335272_u64, 18111980816082568760_u64, 9600326185220173561_u64, 3919948376467652129_u64, 9641509610508493003_u64, 8510628508639664906_u64, 13432371789382939201_u64, 1892979052164438510_u64, 9336307432171021162_u64, 6101479541009619052_u64, 6936178173688573493_u64, 346705494387982_u64],
        [13885304567422267609_u64, 11524734520015831313_u64, 2694379600285341257_u64, 17312962251354131855_u64, 12271705296366856653_u64, 8583568353113930190_u64, 1594210103299474228_u64, 1603288210209904688_u64, 2344547889867420243_u64, 12830704171259885143_u64, 11463746867371943083_u64, 75776823632424_u64],
        [16623947759047688442_u64, 4113361732006110262_u64, 4610753917712625002_u64, 6829415850376296011_u64, 11589075297491659514_u64, 3127687688898024567_u64, 15962999368389834898_u64, 9429673367335304346_u64, 14745869979673018733_u64, 1907662886172548165_u64, 15105446604508210016_u64, 229092266812089_u64]
        ];
        @horizen_cst = Array(BigInt).new
        horizen_cst.each do |b|
            @horizen_cst.push(PoseidonParams.u64a_to_big_int(b));
        end
    end

    def set_horizen_params
        @prime = BigInt.new("41898490967918953402344214791240637128170709919953949071783502921025352812571106773058893763790338921418070971888458477323173057491593855069696241854796396165721416325350064441470418137846398469611935719059908164220784476160001");;
        @sbox = -1;
        @partial_rounds = 57;
        @full_rounds = 8;
        @width = 3;
        set_round_constants(@horizen_cst);
    end

    def set_params(prime, alpha, rf, rp, t)
        @prime = prime;
        @sbox = alpha;
        @partial_rounds = rp;
        @full_rounds = rf;
        @width = t;
    end

    def compute_best_params(prime, t, security)
        @prime = prime
        @sbox = -1;
        if (prime-1 % 5 != 0)
            @sbox = 5
        elsif (prime-1 % 3 != 0)
            @sbox = 3
        end
        @width = t;
        security_margin = true;
        r = calc_final_numbers_fixed(prime, t, @sbox, security, security_margin);
        @full_rounds = r[0];
        @partial_rounds = r[1];
    end

    def generate_grain
        new_bit = @bit_sequence[62] ^ @bit_sequence[51] ^ @bit_sequence[38] ^ @bit_sequence[23] ^ @bit_sequence[13] ^ @bit_sequence[0];
        @bit_sequence.shift
        @bit_sequence.push(new_bit)

        while (new_bit == false)
            new_bit = @bit_sequence[62] ^ @bit_sequence[51] ^ @bit_sequence[38] ^ @bit_sequence[23] ^ @bit_sequence[13] ^ @bit_sequence[0]
            @bit_sequence.shift
            @bit_sequence.push(new_bit)
            new_bit = @bit_sequence[62] ^ @bit_sequence[51] ^ @bit_sequence[38] ^ @bit_sequence[23] ^ @bit_sequence[13] ^ @bit_sequence[0]
            @bit_sequence.shift
            @bit_sequence.push(new_bit)
        end
        new_bit = @bit_sequence[62] ^ @bit_sequence[51] ^ @bit_sequence[38] ^ @bit_sequence[23] ^ @bit_sequence[13] ^ @bit_sequence[0]
        @bit_sequence.shift
        @bit_sequence.push(new_bit)
        
        return new_bit
    end

    def grain_random_bits(num_bits)
        random_bits = ""
        (0...num_bits).each do |i|
            if (generate_grain())
                random_bits += "1";
            else
                random_bits += "0";
            end
        end
        # random_bits.reverse() ## Remove comment to start from least significant bit
        return BigInt.new(random_bits,2);
    end

    # Generate round constants
    # parameters are: 1 (0 for binary fields), field size, number of cells, rf, rp, prime
    def generate_constants(field, n, t, r_ff, r_pp, prime_number)
        @round_constants = Array(BigInt).new();
        num_constants = (r_ff + r_pp) * t
        if field == 0
            (0...num_constants).each do |i|
                random_int = grain_random_bits(n)
                @round_constants.push(random_int)
            end
        elsif field == 1
            (0...num_constants).each do |i|
                random_int = grain_random_bits(n)
                while random_int >= prime_number
                    #pp "[Info] Round constant is not in prime field! Taking next one."
                    random_int = grain_random_bits(n)
                end
                @round_constants.push(random_int)
            end
        end
    end

    #from https://extgit.iaik.tugraz.at/krypto/hadeshash/-/blob/master/code/calc_round_numbers.py
    def sat_inequiv_alpha(prime, t, r_F, r_P, alpha, m_bits)
        n = Math.log(prime,2)
        r_F_1 = 10  # Statistical
        if (alpha > 0) 
            if m_bits <= ((Math.log(prime, 2) - ((alpha-1)/2.0)).floor * (t + 1))
                r_F_1 = 6
            end
            r_F_2 = 1 + (Math.log(2,alpha) * Math.min(m_bits, n)).ceil + (Math.log(alpha,t)).ceil - r_P # Interpolation
            r_F_3 = 1 + (Math.log(2,alpha) * Math.min(m_bits/3_f32, Math.log(prime, 2)/2_f32)) - r_P # Groebner 1
            r_F_4 = t - 1 + Math.min((Math.log(2, alpha) * m_bits) / (t+1).to_f32, ((Math.log(2, alpha)*Math.log(prime, 2)) / 2_f32)) - r_P # Groebner 2
            r_F_max = Math.max(Math.max((r_F_1).ceil, r_F_2.ceil), Math.max(r_F_3.ceil, r_F_4.ceil))
            return (r_F >= r_F_max)
        elsif alpha == (-1)
            if m_bits <= (((Math.log(prime, 2) - 2).floor) * (t + 1)) 
                r_F_1 = 6 
            end
            r_P_1 = 1 + (0.5 * Math.min(m_bits, n)).ceil + (Math.log(t, 2)).ceil - (r_F * Math.log(t, 2)).floor # Interpolation
            r_P_2 = 1 + (0.5 * Math.min(m_bits, n)).ceil + (Math.log(t, 2)).ceil - (r_F * Math.log(t, 2)).floor
            r_P_3 = t - 1 + (Math.log(t, 2)).ceil + Math.min((m_bits / (t+1).to_f32).ceil, (0.5*Math.log(prime, 2)).ceil) - (r_F * Math.log(t, 2)).floor # Groebner 2
            r_F_max = (r_F_1).ceil
            r_P_max = Math.max(Math.max((r_P_1).ceil, (r_P_2).ceil), (r_P_3).ceil)
            return (r_F >= r_F_max && r_P >= r_P_max)
        else
            raise Exception.new("Invalid value for alpha!");
        end
    end
            
    def find_FD_round_numbers(prime, t, alpha, m_bits,  security_margin)
        n = Math.log(prime,2);
    
      #  sat_inequiv = sat_inequiv_alpha 
        r_P = 0
        r_F = 0
        min_cost = (1_f32 / 0_f32).as(Float32);
        max_cost_rf = 0
        # Brute-force approach
        (1...500).each do |r_P_t|
            (4...100).each do |r_F_t|
                if r_F_t % 2 == 0
                   if (sat_inequiv_alpha(prime, t, r_F_t, r_P_t, alpha, m_bits))
                        if security_margin
                            r_F_t += 2
                            r_P_t = (r_P_t * 1.075).ceil
                        end
                        cost = get_sbox_cost(r_F_t, r_P_t, t)
                        #TODO cost = cost_function(r_F_t, r_P_t, N, t)
                        if (cost < min_cost) || ((cost == min_cost) && (r_F_t < max_cost_rf))
                            r_P = (r_P_t).ceil
                            r_F = (r_F_t).ceil
                            min_cost = cost
                            max_cost_rf = r_F
                        end
                    end
                end
            end               
        end                    
        return {r_F, r_P}
    end

    def get_sbox_cost(r_F, r_P, t)
        return t * r_F + r_P;
    end
    
   # def get_size_cost(R_F, R_P, N, t):
    #    n = ceil(float(N) / t)
    #    return int((N * R_F) + (n * R_P))
    

    def calc_final_numbers_fixed(prime, t, alpha, m_bits, security_margin)
        # [Min. S-boxes] Find best possible for t and N
        n = (Math.log(prime, 2)).ceil
        #N = int(n * t)
      ## cost_function = get_sbox_cost
        ret_list = Array(Int32).new();
        rr = find_FD_round_numbers(prime, t, alpha, m_bits, security_margin)  ##cost_function
        pp "rr: #{rr}"
        r_F = rr[0].to_i;
        r_P = rr[1].to_i;
       # min_sbox_cost = cost_function(r_F, r_P,t)
       min_sbox_cost = get_sbox_cost(r_F, r_P, t)
        ret_list.push(r_F)
        ret_list.push(r_P)
        ret_list.push(min_sbox_cost)
    
        # [Min. Size] Find best possible for t and N
        # Minimum number of S-boxes for fixed n results in minimum size also (round numbers are the same)!
       ## min_size_cost = get_size_cost(R_F, R_P, N, t)
       ## ret_list.append(min_size_cost)
    
        return ret_list # [R_F, R_P, min_sbox_cost, min_size_cost]
    end
end

    